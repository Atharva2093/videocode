<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f0f0f">
    <meta name="description" content="Download YouTube videos and playlists on any device">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="YT Downloader">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-16.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <title>YouTube Downloader</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- App Container -->
    <div id="app" class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">ðŸŽ¬</span>
                    <h1>YT Downloader</h1>
                </div>
                <button id="install-btn" class="install-btn hidden" aria-label="Install App">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    <span>Install</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main">
            <!-- URL Input Section -->
            <section class="input-section">
                <div class="input-wrapper">
                    <input 
                        type="url" 
                        id="url-input" 
                        class="url-input" 
                        placeholder="Paste YouTube URL here..."
                        autocomplete="off"
                        autocorrect="off"
                        autocapitalize="off"
                        spellcheck="false"
                        inputmode="url"
                    >
                    <button id="paste-btn" class="paste-btn" aria-label="Paste from clipboard">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
                            <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
                        </svg>
                    </button>
                    <button id="clear-btn" class="clear-btn hidden" aria-label="Clear input">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
                
                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button id="metadata-btn" class="btn btn-secondary btn-large">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <line x1="12" y1="16" x2="12" y2="12"/>
                            <line x1="12" y1="8" x2="12.01" y2="8"/>
                        </svg>
                        <span>Get Info</span>
                    </button>
                    <button id="download-btn" class="btn btn-primary btn-large" disabled>
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        <span>Download</span>
                    </button>
                </div>
            </section>

            <!-- Preview Section (Hidden by default) -->
            <section id="preview-section" class="preview-section hidden">
                <!-- Video Card -->
                <div class="video-card">
                    <div class="thumbnail-wrapper">
                        <img id="thumbnail" src="" alt="Video thumbnail" class="thumbnail">
                        <span id="duration-badge" class="duration-badge"></span>
                        <div class="thumbnail-overlay">
                            <button id="thumbnail-play" class="play-btn" aria-label="Preview">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                                    <polygon points="5 3 19 12 5 21 5 3"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="video-details">
                        <h2 id="video-title" class="video-title"></h2>
                        <div class="video-meta">
                            <span id="channel-name" class="channel"></span>
                            <span class="meta-separator">â€¢</span>
                            <span id="view-count" class="views"></span>
                        </div>
                        <p id="video-description" class="video-description"></p>
                    </div>
                </div>

                <!-- Format Selection -->
                <div class="format-selection">
                    <h3>Download Options</h3>
                    <div class="format-tabs">
                        <button class="format-tab active" data-format="video">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/>
                                <line x1="7" y1="2" x2="7" y2="22"/>
                                <line x1="17" y1="2" x2="17" y2="22"/>
                                <line x1="2" y1="12" x2="22" y2="12"/>
                                <line x1="2" y1="7" x2="7" y2="7"/>
                                <line x1="2" y1="17" x2="7" y2="17"/>
                                <line x1="17" y1="17" x2="22" y2="17"/>
                                <line x1="17" y1="7" x2="22" y2="7"/>
                            </svg>
                            Video
                        </button>
                        <button class="format-tab" data-format="audio">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M9 18V5l12-2v13"/>
                                <circle cx="6" cy="18" r="3"/>
                                <circle cx="18" cy="16" r="3"/>
                            </svg>
                            Audio
                        </button>
                        <button class="format-tab" data-format="mobile">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="5" y="2" width="14" height="20" rx="2" ry="2"/>
                                <line x1="12" y1="18" x2="12.01" y2="18"/>
                            </svg>
                            Mobile
                        </button>
                    </div>

                    <!-- Quality Options -->
                    <div id="quality-options" class="quality-options">
                        <label class="quality-label">Quality</label>
                        <div class="quality-grid" id="quality-grid">
                            <button class="quality-btn active" data-quality="best">Best</button>
                            <button class="quality-btn" data-quality="1080p">1080p</button>
                            <button class="quality-btn" data-quality="720p">720p</button>
                            <button class="quality-btn" data-quality="480p">480p</button>
                            <button class="quality-btn" data-quality="360p">360p</button>
                        </div>
                    </div>

                    <!-- Available Formats (Collapsible) -->
                    <details id="formats-details" class="formats-details">
                        <summary>
                            <span>Available Formats</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"/>
                            </svg>
                        </summary>
                        <div id="formats-list" class="formats-list"></div>
                    </details>
                </div>
            </section>

            <!-- Playlist Section (Hidden by default) -->
            <section id="playlist-section" class="playlist-section hidden">
                <div class="playlist-header">
                    <div class="playlist-info">
                        <h3 id="playlist-title">Playlist</h3>
                        <span id="playlist-count" class="playlist-count">0 videos</span>
                    </div>
                    <div class="playlist-actions">
                        <button id="select-all-btn" class="btn btn-small">Select All</button>
                        <span id="selected-count" class="selected-count">0 selected</span>
                    </div>
                </div>
                <div id="playlist-container" class="playlist-container"></div>
            </section>

            <!-- Download Queue Section -->
            <section id="queue-section" class="queue-section">
                <div class="queue-header">
                    <h3>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        Downloads
                    </h3>
                    <button id="clear-queue-btn" class="btn btn-small btn-ghost">Clear</button>
                </div>
                <div id="queue-container" class="queue-container">
                    <div class="queue-empty">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        <p>No downloads yet</p>
                        <span>Paste a YouTube URL to get started</span>
                    </div>
                </div>
            </section>
        </main>

        <!-- Sticky Bottom Action Bar (Mobile) -->
        <div id="bottom-bar" class="bottom-bar hidden">
            <div class="bottom-bar-info">
                <span id="bottom-bar-title" class="bottom-title"></span>
                <span id="bottom-bar-size" class="bottom-size"></span>
            </div>
            <button id="bottom-download-btn" class="btn btn-primary">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="7 10 12 15 17 10"/>
                    <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download Now
            </button>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="api-status">
                    <span id="api-status" class="status-dot"></span>
                    <span id="api-status-text">Connecting...</span>
                </div>
                <span class="footer-version">v2.0</span>
            </div>
        </footer>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-spinner"></div>
        <p id="loading-text">Loading...</p>
    </div>

    <!-- Download Modal -->
    <div id="download-modal" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3>Download Ready</h3>
                <button class="modal-close" aria-label="Close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="download-ready-icon">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                        <polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                </div>
                <p id="modal-filename" class="modal-filename"></p>
                <p id="modal-filesize" class="modal-filesize"></p>
            </div>
            <div class="modal-actions">
                <a id="modal-download-link" href="#" class="btn btn-primary btn-large" download>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    Save to Device
                </a>
            </div>
        </div>
    </div>

    <!-- Offline Banner -->
    <div id="offline-banner" class="offline-banner hidden">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="1" y1="1" x2="23" y2="23"/>
            <path d="M16.72 11.06A10.94 10.94 0 0 1 19 12.55"/>
            <path d="M5 12.55a10.94 10.94 0 0 1 5.17-2.39"/>
            <path d="M10.71 5.05A16 16 0 0 1 22.58 9"/>
            <path d="M1.42 9a15.91 15.91 0 0 1 4.7-2.88"/>
            <path d="M8.53 16.11a6 6 0 0 1 6.95 0"/>
            <line x1="12" y1="20" x2="12.01" y2="20"/>
        </svg>
        <span>You're offline. Some features may be unavailable.</span>
    </div>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('SW registered:', reg.scope))
                    .catch(err => console.log('SW registration failed:', err));
            });
        }
    </script>
</body>
</html>
